<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Teal Video Compressor</title>
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    body{background:#e0f7f7;color:#004d4d;font-family:sans-serif}
    header{background:#008080;color:#fff;padding:1rem;text-align:center;font-size:1.5rem}
    .container{max-width:600px;margin:auto;padding:1rem}
    .card{background:#fff;padding:1rem;border-radius:10px;box-shadow:0 0 10px rgba(0,0,0,0.1)}
    input,select,button{width:100%;padding:0.7rem;margin-bottom:1rem;border:1px solid #ccc;border-radius:5px}
    button{background:#009999;color:#fff;font-weight:bold;cursor:pointer}
    button:disabled{background:#76cfcf;cursor:default}
    .progress{width:100%;height:20px;background:#ccc;border-radius:10px;overflow:hidden;margin:1rem 0}
    .progress-bar{height:100%;background:#00b3b3;width:0;transition:width .2s}
    #status{margin-bottom:1rem;text-align:center;color:#006666;font-size:0.95rem}
    .download{display:none;text-align:center}
    .download a{color:#004d4d;font-weight:bold;text-decoration:none}
  </style>
</head>
<body>
  <header>üìπ Teal Video Compressor</header>
  <div class="container">
    <div class="card">
      <input type="file" id="videoInput" accept="video/*">
      <select id="quality">
        <option value="360">Low (360p)</option>
        <option value="480">Medium (480p)</option>
        <option value="720">High (720p)</option>
      </select>
      <button id="startBtn">Start Compression</button>
      <div id="status">Ready ‚úîÔ∏è</div>
      <div class="progress"><div class="progress-bar" id="progressBar"></div></div>
      <div class="download" id="downloadSection">
        ‚úÖ Done! <a id="downloadLink" href="#" download="compressed.mp4">Download</a>
      </div>
    </div>
  </div>  <script type="module">
    import { createFFmpeg, fetchFile } from 'https://cdn.jsdelivr.net/npm/@ffmpeg/ffmpeg@0.11.1/dist/ffmpeg.min.js';
    const status = document.getElementById('status');
    const progressBar = document.getElementById('progressBar');
    const videoInput = document.getElementById('videoInput');
    const qualitySel = document.getElementById('quality');
    const startBtn = document.getElementById('startBtn');
    const dlLink = document.getElementById('downloadLink');
    const dlSection = document.getElementById('downloadSection');

    const ffmpeg = createFFmpeg({
      log: true,
      corePath: 'https://cdn.jsdelivr.net/npm/@ffmpeg/core@0.11.1/dist/ffmpeg-core.js',
      progress: ({ ratio }) => {
        const pct = Math.round(ratio * 100);
        console.log('Progress:', pct);
        progressBar.style.width = pct + '%';
        status.textContent = 'Compressing: ' + pct + '%';
      }
    });

    startBtn.addEventListener('click', async () => {
      console.log('Start button clicked');
      status.textContent = 'Start clicked';
      const file = videoInput.files[0];
      if (!file) {
        alert('Please select a video file first!');
        return;
      }
      const quality = qualitySel.value;
      const outputName = `out_${quality}.mp4`;
      startBtn.disabled = true;
      dlSection.style.display = 'none';
      progressBar.style.width = '0%';
      try {
        status.textContent = 'Loading ffmpeg...';
        console.log('Loading ffmpeg');
        if (!ffmpeg.isLoaded()) await ffmpeg.load();
        console.log('ffmpeg loaded');
        status.textContent = 'Writing file to FS...';
        ffmpeg.FS('writeFile', file.name, await fetchFile(file));
        console.log('File written:', file.name);
        status.textContent = 'Running compression...';
        await ffmpeg.run(
          '-i', file.name,
          '-vf', `scale=-2:${quality}`,
          '-c:v', 'libx264',
          '-preset', 'fast',
          '-c:a', 'aac',
          outputName
        );
        console.log('Compression run complete');
        const data = ffmpeg.FS('readFile', outputName);
        const blob = new Blob([data.buffer], { type: 'video/mp4' });
        const url = URL.createObjectURL(blob);
        dlLink.href = url;
        dlLink.download = `compressed_${quality}p.mp4`;
        dlSection.style.display = 'block';
        status.textContent = '‚úÖ Compression complete!';
      } catch (err) {
        console.error('Error:', err);
        status.textContent = '‚ùå Error: ' + err.message;
      } finally {
        startBtn.disabled = false;
      }
    });
  </script></body>
</html>